<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: kernel/EventEmitter.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: kernel/EventEmitter.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var solfege = require('../solfege');
var assert = require('assert');

/**
 * An event emitter written with generators
 *
 * @class solfege.kernel.EventEmitter
 */
var EventEmitter = solfege.util.Class.create(function()
{
    // Initialize the map of listeners
    this.listeners = new Map();

}, 'solfege.kernel.EventEmitter');
var proto = EventEmitter.prototype;


/**
 * The listeners
 *
 * @private
 * @member {Map} solfege.kernel.EventEmitter.prototype.listeners
 */
proto.listeners;

/**
 * Emit an event
 *
 * @public
 * @method  solfege.kernel.EventEmitter.prototype.emit
 * @param   {String} name - The event name
 * @param   {...*} parameter - A parameter
 */
proto.emit = function*(name)
{
    // Check the parameters
    assert.strictEqual(typeof name, 'string', 'The name must be a string');

    // Get the listeners
    var eventListeners = this.getEventListeners(name);

    // Build the handler arguments
    var handlerArguments = [];
    var argumentCount = arguments.length;
    for (var argumentIndex = 1; argumentIndex &lt; argumentCount; ++argumentIndex) {
        handlerArguments.push(arguments[argumentIndex]);
    }

    // Execute each handler
    var listenerCount = eventListeners.length;
    for (var listenerIndex = 0; listenerIndex &lt; listenerCount; ++listenerIndex) {
        var handler = eventListeners[listenerIndex];
        yield *handler.apply(this, handlerArguments);
    }
};

/**
 * Add a listener
 *
 * @public
 * @method  solfege.kernel.EventEmitter.prototype.on
 * @param   {String} name - The event name
 * @param   {Function} handler - The listener function
 */
proto.on = function(name, handler)
{
    // Check the name
    assert.strictEqual(typeof name, 'string', 'The name must be a string');

    // Check the handler
    assert.strictEqual(typeof handler, 'function', 'The event handler must be a generator function');
    assert.strictEqual(handler.constructor.name, 'GeneratorFunction', 'The event handler must be a generator function');

    var eventListeners = this.getEventListeners(name);
    eventListeners.push(handler);
};

/**
 * Get the listeners of an event name
 *
 * @private
 * @method  solfege.kernel.EventEmitter.prototype.getEventListeners
 * @param   {String} name - The event name
 * @return  {Function[]} The listeners
 */
proto.getEventListeners = function(name)
{
    // Check the name
    assert.strictEqual(typeof name, 'string', 'The name must be a string');


    var eventListeners;

    if (this.listeners.has(name)) {
        eventListeners = this.listeners.get(name);
    } else {
        eventListeners = [];
        this.listeners.set(name, eventListeners);
    }

    return eventListeners;
};

module.exports = EventEmitter;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="solfege.util.module_Class.html">Class</a></li><li><a href="solfege.util.module_Function.html">Function</a></li><li><a href="solfege.util.module_Object.html">Object</a></li><li><a href="solfege.util.module_ObjectProxy.html">ObjectProxy</a></li><li><a href="solfege.util.Node.module_fs.html">fs</a></li></ul><h3>Classes</h3><ul><li><a href="solfege.kernel.Application.html">Application</a></li><li><a href="solfege.kernel.EventEmitter.html">EventEmitter</a></li><li><a href="solfege.kernel.Services.html">Services</a></li></ul><h3>Namespaces</h3><ul><li><a href="solfege.html">solfege</a></li><li><a href="solfege.kernel.html">kernel</a></li><li><a href="solfege.util.html">util</a></li><li><a href="solfege.util.Node.html">Node</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-beta3</a> on Sat May 02 2015 16:58:46 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
